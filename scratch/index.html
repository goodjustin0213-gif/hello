<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>國軍財務戰略模擬系統 v22.0 | 實戰校正版</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=Roboto+Mono:wght@500&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f1f5f9; color: #334155; height: 100vh; overflow: hidden; }
        .mono { font-family: 'Roboto Mono', monospace; }
        
        /* 佈局容器 */
        .layout { display: flex; height: 100%; }
        
        /* 左側參數欄 */
        .sidebar { 
            width: 400px; background: white; border-right: 1px solid #cbd5e1; 
            display: flex; flex-direction: column; z-index: 10;
        }
        .sidebar-header { padding: 16px; background: #1e293b; color: white; flex-shrink: 0; }
        .sidebar-content { flex: 1; overflow-y: auto; padding: 16px; }
        
        /* 右側主畫面 */
        .main { flex: 1; overflow-y: auto; padding: 24px; background: #f8fafc; }

        /* 模組標題 */
        .section-label { 
            font-size: 0.8rem; font-weight: 700; color: #1e293b; text-transform: uppercase; 
            border-left: 4px solid #2563eb; padding-left: 8px; margin: 20px 0 10px 0; 
            background: #eff6ff; padding-top: 4px; padding-bottom: 4px;
        }

        /* 輸入元件 */
        .input-group { margin-bottom: 12px; }
        label { display: block; font-size: 0.75rem; font-weight: 700; color: #64748b; margin-bottom: 4px; }
        input, select { 
            width: 100%; padding: 8px; border: 1px solid #cbd5e1; border-radius: 6px; 
            font-size: 0.9rem; font-weight: 500; color: #0f172a; background: #fff;
        }
        input:focus, select:focus { outline: 2px solid #2563eb; border-color: transparent; }
        
        /* 特別強調輸入 */
        .input-highlight { border: 2px solid #3b82f6; background: #eff6ff; color: #1e40af; font-weight: 700; }

        /* A/B 切換 */
        .tab-bar { display: flex; background: #e2e8f0; padding: 4px; border-radius: 8px; margin-bottom: 16px; flex-shrink: 0; }
        .tab-btn { flex: 1; text-align: center; padding: 8px; font-size: 0.85rem; font-weight: 700; cursor: pointer; border-radius: 6px; transition: 0.2s; }
        .tab-active { background: white; color: #2563eb; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .tab-inactive { color: #64748b; }

        /* 卡片與圖表 */
        .card { background: white; border: 1px solid #e2e8f0; border-radius: 12px; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.02); margin-bottom: 20px; }
        .chart-box { position: relative; height: 280px; width: 100%; }

        /* 動態列表 */
        .list-item { display: flex; gap: 8px; margin-bottom: 6px; align-items: center; }
        .btn-add { width: 100%; padding: 6px; border: 1px dashed #94a3b8; color: #64748b; font-size: 0.8rem; font-weight: 700; border-radius: 6px; margin-top: 4px; transition: 0.2s; }
        .btn-add:hover { background: #eff6ff; color: #2563eb; border-color: #2563eb; }
    </style>
</head>
<body>

<div class="layout">
    <aside class="sidebar">
        <div class="sidebar-header">
            <h1 class="text-lg font-black tracking-wider">國軍財務戰略模擬</h1>
            <p class="text-xs text-slate-400">V22.0 實戰校正版 (Reality Check)</p>
        </div>
        
        <div class="p-4 bg-white border-b border-slate-200">
            <div class="tab-bar">
                <div onclick="app.switch('A')" id="btn-A" class="tab-btn tab-active">方案 A (主案)</div>
                <div onclick="app.switch('B')" id="btn-B" class="tab-btn tab-inactive">方案 B (對照)</div>
            </div>
        </div>

        <div class="sidebar-content">
            <div class="section-label">1. 薪資基準校正 (Base Calibration)</div>
            <div class="input-group">
                <label>目前階級</label>
                <select id="currentRank"></select>
            </div>
            <div class="grid grid-cols-2 gap-3 mb-2">
                <div class="input-group">
                    <label>已服役年資 (年)</label>
                    <input type="number" id="pastYears" value="0" placeholder="計算年功俸用">
                </div>
                <div class="input-group">
                    <label>預計再服役 (年)</label>
                    <input type="number" id="futureYears" value="20">
                </div>
            </div>
            <div class="input-group">
                <label class="text-blue-700">★ 目前實領月薪 (含所有加給)</label>
                <input type="number" id="realMonthlyPay" value="0" class="input-highlight" placeholder="若輸入，系統將以此為準">
                <p class="text-[10px] text-slate-400 mt-1">* 若輸入 0，則使用系統預設資料庫推算</p>
            </div>
            
            <div class="section-label">2. 晉升與加給 (Promotion)</div>
            <div class="input-group">
                <label>目標階級 (最高歷練)</label>
                <select id="targetRank"></select>
            </div>
            <label>額外加給 (如: 戰鬥/外島/主管)</label>
            <div id="allowance-list"></div>
            <button onclick="app.addItem('allowance-list')" class="btn-add">+ 新增加給項目</button>

            <div class="section-label">3. 收支與投資 (Accounting)</div>
            <div class="input-group">
                <label>每月總支出 (生活+保險+孝親)</label>
                <input type="number" id="totalExpense" value="18000">
            </div>
            <div class="input-group">
                <div class="flex justify-between">
                    <label>薪資提撥率</label>
                    <span id="investRateVal" class="text-blue-600 font-bold text-xs">30%</span>
                </div>
                <input type="range" id="investRate" min="0" max="90" value="30" oninput="document.getElementById('investRateVal').innerText=this.value+'%'; app.calc()">
            </div>
            <div class="grid grid-cols-2 gap-3 mb-2">
                <div class="input-group"><label>年化報酬(%)</label><input type="number" id="roi" value="6.0" step="0.5"></div>
                <div class="input-group"><label>通膨率(%)</label><input type="number" id="inflation" value="2.0" step="0.1"></div>
            </div>
            <label>定期定額 (固定金額)</label>
            <div id="invest-list"></div>
            <button onclick="app.addItem('invest-list')" class="btn-add">+ 新增固定投資</button>

            <div class="section-label">4. 房產模擬 (Real Estate)</div>
            <div class="flex items-center gap-2 mb-2 bg-slate-50 p-2 rounded border border-slate-200">
                <input type="checkbox" id="buyHouse" class="w-4 h-4" onchange="app.calc()">
                <label for="buyHouse" class="mb-0 cursor-pointer text-slate-700">啟用購屋試算</label>
            </div>
            <div id="housing-opts" class="hidden space-y-2 pl-2 border-l-2 border-slate-300">
                <div class="input-group"><label>購屋時間 (第N年)</label><input type="number" id="buyYear" value="10"></div>
                <div class="input-group"><label>房屋總價 (萬)</label><input type="number" id="housePrice" value="1200"></div>
                <div class="grid grid-cols-2 gap-2">
                    <div class="input-group"><label>頭期款 (%)</label><input type="number" id="downPayment" value="20"></div>
                    <div class="input-group"><label>年限</label><input type="number" id="loanYears" value="30"></div>
                </div>
            </div>
            <div class="h-20"></div>
        </div>
    </aside>

    <main class="main">
        <div class="grid grid-cols-3 gap-6 mb-6">
            <div class="card border-l-4 border-blue-600 p-4">
                <p class="text-xs font-bold text-slate-400 uppercase">方案 A 淨資產</p>
                <p id="kpi-net-A" class="text-3xl font-black text-blue-700 mono mt-1">--</p>
            </div>
            <div class="card border-l-4 border-slate-400 p-4">
                <p class="text-xs font-bold text-slate-400 uppercase">方案 B 淨資產</p>
                <p id="kpi-net-B" class="text-3xl font-black text-slate-600 mono mt-1">--</p>
            </div>
            <div class="card border-l-4 border-emerald-500 p-4">
                <p class="text-xs font-bold text-slate-400 uppercase">差異 (A - B)</p>
                <p id="kpi-diff" class="text-3xl font-black text-emerald-600 mono mt-1">--</p>
            </div>
        </div>

        <div class="grid grid-cols-2 gap-6 mb-6">
            <div class="card">
                <h3 class="font-bold text-slate-700 mb-4 flex items-center gap-2">
                    <span class="w-2 h-2 bg-blue-500 rounded-full"></span> 資產累積對照
                </h3>
                <div class="chart-box"><canvas id="chart-asset"></canvas></div>
            </div>
            <div class="card">
                <h3 class="font-bold text-slate-700 mb-4 flex items-center gap-2">
                    <span class="w-2 h-2 bg-emerald-500 rounded-full"></span> 方案 A 資產結構
                </h3>
                <div class="chart-box"><canvas id="chart-wealth"></canvas></div>
            </div>
        </div>

        <div class="card p-0 overflow-hidden">
            <div class="p-4 bg-slate-50 border-b border-slate-200 font-bold text-slate-700">詳細財務明細表 (單位：元)</div>
            <div class="overflow-x-auto max-h-[500px]">
                <table class="w-full text-sm text-left">
                    <thead class="bg-white text-slate-500 font-bold sticky top-0 shadow-sm">
                        <tr>
                            <th class="p-3 text-center">年</th>
                            <th class="p-3">階級</th>
                            <th class="p-3 text-right text-blue-600">總收入</th>
                            <th class="p-3 text-right text-red-500">總支出</th>
                            <th class="p-3 text-right text-emerald-600">投入投資</th>
                            <th class="p-3 text-right text-orange-500">房貸</th>
                            <th class="p-3 text-right font-black">淨資產</th>
                        </tr>
                    </thead>
                    <tbody id="table-body" class="divide-y divide-slate-100 text-slate-700"></tbody>
                </table>
            </div>
        </div>
    </main>
</div>

<script src="main.js"></script>
</body>
</html>
